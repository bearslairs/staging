(this["webpackJsonpbearslairs-serverless-react"]=this["webpackJsonpbearslairs-serverless-react"]||[]).push([[0],{286:function(e,t,a){e.exports=a.p+"static/media/privacy.bf6275f6.md"},287:function(e,t,a){e.exports=a.p+"static/media/terms.a65f2484.md"},310:function(e,t,a){e.exports=a(562)},316:function(e,t,a){},460:function(e,t){},562:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(20),o=a.n(c),l=a(33),i=(a(315),a(316),a(317),a(13)),s=a.n(i),u=a(23),m=a(9),d=a(184),p=a(25),b=a(31),f=a(11),h=a(85),E=a(22),g=a(14),y=a(155),v=a(161),x=a(70),k=a(58),O=a(125),j=a(43),w=Object(n.createContext)(null);function I(){return Object(n.useContext)(w)}function N(e){var t=e.children,a=Object(j.a)(e,["children"]),n=Object(p.l)(),c=n.pathname,o=n.search,l=I().isAuthenticated;return r.a.createElement(p.d,a,l?t:r.a.createElement(p.c,{to:"/login?redirect=".concat(c).concat(o)}))}function C(e){var t=e.children,a=Object(j.a)(e,["children"]),n=I().isAuthenticated,c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.href;e=e.replace(/[[]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)","i"),n=a.exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}("redirect");return r.a.createElement(p.d,a,n?r.a.createElement(p.c,{to:""===c||null===c?"/":c}):t)}var _=a(15),S=a(56),F=a(283),T=a(285),L=a.n(T);function A(){var e=["/lair-baby.png","/lair-mama.png","/lair-papa.png"],t=["/lair-baby-icon.png","/lair-mama-icon.png","/lair-papa-icon.png"],a=["/bike-rack.png","/bike-small.png","/bike-large.png"],c=["/bike-rack-icon.png","/bike-small-icon.png","/bike-large-icon.png"],o=Object(n.useState)({language:"en",copy:{carousel:[],blurbs:[],cards:[]}}),l=Object(m.a)(o,2),i=l[0],s=l[1],u=Object(n.useState)({temperature:{created_at:Date.now(),value:0},humidity:{created_at:Date.now(),value:0}}),d=Object(m.a)(u,2),p=d[0],y=d[1];return Object(n.useEffect)((function(){fetch("https://raw.githubusercontent.com/bearslairs/bearslairs-data/master/copy/"+i.language+"/home.json").then((function(e){return e.json()})).then((function(e){s({language:i.language,copy:e})})).catch(console.log)}),[i]),Object(n.useEffect)((function(){fetch("https://api.ubibot.io/channels/13604?api_key=609210eb2306427a88d662d48ddb578d").then((function(e){return e.json()})).then((function(e){if("success"===e.result){var t=JSON.parse(e.channel.last_values);y({temperature:t.field1,humidity:t.field2})}})).catch(console.log)}),[p]),r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{id:"header",fluid:!0},r.a.createElement("h2",null,"secure self storage in bansko",r.a.createElement("br",null),"with access at your convenience")),r.a.createElement(f.a,{id:"environment"},r.a.createElement("h3",null,"real-time environment monitoring"),r.a.createElement("p",null,"we monitor temperature, humidity and light within the facility and publish those readings at \xa0",r.a.createElement("a",{href:"https://space.ubibot.io/space/user/device/channel-id/13604"},"ubibot.io/bearslairs-bansko"),",",r.a.createElement("br",null),"so our customers can stay informed of the environmetal conditions of their self-storage. The latest readings taken were:"),r.a.createElement(E.a,{className:"justify-content-xl-center justify-content-md-center"},r.a.createElement(g.a,{xl:"auto",md:"auto"},r.a.createElement(L.a,{theme:"dark",value:Math.round(10*p.temperature.value)/10,max:1.3*p.temperature.value,steps:"3",format:"\xb0C",size:"large",height:"200"})),r.a.createElement(g.a,{xl:"auto",md:"auto"},r.a.createElement("h4",null,"temperature"),new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"long",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric",timeZone:"Europe/Sofia"}).format(new Date(p.temperature.created_at)),":\xa0",r.a.createElement("strong",null,Math.round(10*p.temperature.value)/10,"\xb0C"),r.a.createElement("h4",null,"humidity"),new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"long",day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric",timeZone:"Europe/Sofia"}).format(new Date(p.humidity.created_at)),":\xa0",r.a.createElement("strong",null,p.humidity.value,"%")))),r.a.createElement(f.a,{id:"about",fluid:!0},i.copy.blurbs.slice(0,1).map((function(e,t){return r.a.createElement(f.a,{key:t},r.a.createElement("h3",null,e.title),r.a.createElement(E.a,{className:"justify-content-xl-center justify-content-md-center"},e.copy.map((function(t,a){return r.a.createElement(g.a,{xl:12/e.copy.length,key:a},r.a.createElement(h.a,{src:t.image}),r.a.createElement("p",null,t.text))}))))}))),r.a.createElement(f.a,{id:"security",fluid:!0},r.a.createElement(f.a,null,r.a.createElement(E.a,{className:"justify-content-xl-center justify-content-md-center"},i.copy.blurbs.slice(1,2).map((function(e,t){return r.a.createElement(g.a,{xl:7,key:t},r.a.createElement("h3",null,e.title),e.copy.map((function(e,t){return r.a.createElement("p",{key:t},e)})),r.a.createElement(b.LinkContainer,{to:"/booking/new"},r.a.createElement(S.a,null,"book now")))}))))),r.a.createElement(f.a,{id:"lair"},r.a.createElement("h3",null,"choose your lair"),r.a.createElement(E.a,{className:"justify-content-xl-center justify-content-md-center"},i.copy.cards.slice(0,3).map((function(a,n){return r.a.createElement(g.a,{key:n},r.a.createElement(_.a,{className:"h-100"},r.a.createElement(_.a.Header,null,a.title),r.a.createElement("div",{style:{height:"200px",backgroundImage:"url("+e[n]+")"}},r.a.createElement(h.a,{src:t[n],alt:a.image.alt,style:{marginTop:"25px"}})),r.a.createElement(_.a.Body,null,r.a.createElement(_.a.Title,null,a.description.join(" ")),r.a.createElement("hr",null),r.a.createElement("ul",{style:{lmargin:0,padding:0}},a.features.map((function(e,t){return r.a.createElement("li",{key:t,style:{listStyleType:"none",fontWeight:600,margin:0,padding:0}},e.text,r.a.createElement("ul",{style:{lmargin:0,padding:0}},e.details.map((function(e,t){return r.a.createElement("li",{key:t,style:{listStyleType:"none",fontWeight:"normal",margin:0,padding:0}},e)}))))})))),r.a.createElement(_.a.Footer,null,r.a.createElement(b.LinkContainer,{to:a.button.link},r.a.createElement(S.a,null,a.button.text)))))})))),r.a.createElement(f.a,{id:"adaptive",fluid:!0},i.copy.blurbs.slice(2,3).map((function(e,t){return r.a.createElement(f.a,{key:t},r.a.createElement("h3",null,e.title),r.a.createElement(E.a,{className:"justify-content-xl-center justify-content-md-center"},r.a.createElement(g.a,{xl:7},r.a.createElement("p",null,e.copy[0]))),r.a.createElement("blockquote",{className:"blockquote"},r.a.createElement("p",null,e.copy[1])))}))),r.a.createElement(f.a,{id:"bike",fluid:!0},i.copy.blurbs.slice(3,4).map((function(e,t){return r.a.createElement(f.a,{key:t},r.a.createElement("h3",null,e.title),r.a.createElement(E.a,{className:"justify-content-xl-center justify-content-md-center"},r.a.createElement(g.a,{xl:8},r.a.createElement("p",null,e.copy[0]))))})),r.a.createElement(f.a,null,r.a.createElement(E.a,null,i.copy.cards.slice(3,6).map((function(e,t){return r.a.createElement(g.a,{key:t},r.a.createElement(_.a,{className:"h-100"},r.a.createElement(_.a.Header,null,e.title),r.a.createElement("div",{style:{height:"200px",backgroundImage:"url("+a[t]+")"}},r.a.createElement(h.a,{src:c[t],alt:e.image.alt,style:{marginTop:"25px"}})),r.a.createElement(_.a.Body,null,r.a.createElement(_.a.Title,null,e.description.join(" ")),r.a.createElement("hr",null),r.a.createElement("ul",{style:{lmargin:0,padding:0}},e.features.map((function(e,t){return r.a.createElement("li",{key:t,style:{listStyleType:"none",fontWeight:600,margin:0,padding:0}},e.text,r.a.createElement("ul",{style:{margin:0,padding:0}},e.details.map((function(e,t){return r.a.createElement("li",{key:t,style:{listStyleType:"none",fontWeight:"normal",margin:0,padding:0}},e)}))))})))),r.a.createElement(_.a.Footer,null,r.a.createElement(b.LinkContainer,{to:e.button.link},r.a.createElement(S.a,null,e.button.text)))))}))))),r.a.createElement(f.a,{id:"facility",fluid:!0},i.copy.blurbs.slice(4,5).map((function(e,t){return r.a.createElement(f.a,{key:t},r.a.createElement("h3",null,e.title),r.a.createElement(E.a,{className:"justify-content-xl-center justify-content-md-center"},e.copy.map((function(t,a){return r.a.createElement(g.a,{xl:12/e.copy.length,key:a},r.a.createElement(h.a,{src:t.image}),r.a.createElement("p",null,t.text))}))),r.a.createElement(E.a,{className:"justify-content-xl-center justify-content-md-center"},r.a.createElement(g.a,{xl:"auto",md:"auto"},r.a.createElement(b.LinkContainer,{to:"/booking/new"},r.a.createElement(S.a,null,"book now")))))}))),r.a.createElement(f.a,{id:"map",fluid:!0},r.a.createElement("div",{style:{height:"650px",width:"100%"}},"localhost"===window.location.hostname?null:r.a.createElement(F.a,{bootstrapURLKeys:{key:"AIzaSyCKw8by28pNI5tlimezyyjgtXz_Nvkq2-Y"},defaultCenter:{lat:41.820582,lng:23.478257},defaultZoom:14,onGoogleApiLoaded:function(e){var t=e.map,a=e.maps,n=new a.Marker({position:{lat:41.820582,lng:23.478257},map:t,title:"Bears Lairs, Bansko",description:"secure, self-storage in bansko with access at your convenience",link:{url:"https://www.google.com/maps/place/Bears+Lairs/@41.8223813,23.4681867,15z/data=!4m5!3m4!1s0x0:0xadd4ea4c0b9a3216!8m2!3d41.820631!4d23.478215",text:"maps.google.com/Bears+Lairs"}}),r=new a.InfoWindow({content:'<h4><img src="favicon-32x32.png" style="margin-right: 6px;" class="rounded-circle" />'+n.title+"</h4><p>"+n.description+'<br /><a href="'+n.link.url+'">'+n.link.text+"</a></p>"});r.open(t,n),n.addListener("click",(function(){t.setZoom(14),t.setCenter(n.getPosition()),r.open(t,n)}))}}))))}var P=a(140),M=a.n(P),D=a(286),q=a.n(D);function G(){var e=Object(n.useState)(void 0),t=Object(m.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){fetch(q.a).then((function(e){return e.text()})).then(c)}),[]),r.a.createElement(f.a,{id:"policy"},r.a.createElement(M.a,{source:a}))}var V=a(287),Y=a.n(V);function R(){var e=Object(n.useState)(void 0),t=Object(m.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){fetch(Y.a).then((function(e){return e.text()})).then(c)}),[]),r.a.createElement(f.a,{id:"policy"},r.a.createElement(M.a,{source:a}))}var U=a(574),B=a(3),$=a(81);function z(e){var t=e.isLoading,a=e.disabled,n=void 0!==a&&a,c=Object(j.a)(e,["isLoading","disabled"]);return r.a.createElement(S.a,Object.assign({disabled:n||t},c),t&&r.a.createElement($.a,{animation:"border",size:"sm",style:{marginRight:"0.7em"}}),c.children)}var W=a(67),K=a(12);function H(e){var t=Object(n.useState)(e),a=Object(m.a)(t,2),r=a[0],c=a[1];return[r,function(e){c(Object(K.a)({},r,Object(W.a)({},e.target.id,e.target.value)))}]}function Z(e){var t=e.toString();e instanceof Error||!e.message||(t=e.message),alert(t)}var J="e986bca0-ff41-11ea-8196-af25e422bd08",X="ff1694c0-ffa8-11ea-bfbc-4f270cb046f3";function Q(){var e=Object(p.k)(),t=I().userHasAuthenticated,a=Object(n.useState)(!1),c=Object(m.a)(a,2),o=c[0],i=c[1],b=H({email:"",password:""}),f=Object(m.a)(b,2),h=f[0],E=f[1];function g(){return(g=Object(u.a)(s.a.mark((function a(n){var r;return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n.preventDefault(),i(!0),a.prev=2,a.next=5,d.a.signIn(h.email,h.password);case 5:return t(!0),a.next=8,d.a.currentAuthenticatedUser();case 8:r=a.sent,"custom:stripe_customer_id"in r.attributes||U.a.put("limelockers","/".concat(J,"/").concat(X,"/customer"),{body:{email:h.email}}).then(function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.status&&t.customer&&t.customer.id)){e.next=5;break}return e.next=3,d.a.updateUserAttributes(r,{"custom:stripe_customer_id":t.customer.id});case 3:e.next=6;break;case 5:t.error&&console.log(t.error);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.push("/"),a.next=18;break;case 14:a.prev=14,a.t0=a.catch(2),Z(a.t0),i(!1);case 18:case"end":return a.stop()}}),a,null,[[2,14]])})))).apply(this,arguments)}return r.a.createElement(_.a,{id:"login"},r.a.createElement(_.a.Header,null,"Already a Customer?",r.a.createElement("span",{className:"float-right"},"Log In")),r.a.createElement(_.a.Body,null,r.a.createElement(B.a,{onSubmit:function(e){return g.apply(this,arguments)}},r.a.createElement(B.a.Group,{controlId:"email"},r.a.createElement(B.a.Label,null,"Email"),r.a.createElement(B.a.Control,{autoFocus:!0,type:"email",value:h.email,onChange:E})),r.a.createElement(B.a.Group,{controlId:"password"},r.a.createElement(B.a.Label,null,"Password"),r.a.createElement(B.a.Control,{type:"password",value:h.password,onChange:E})),r.a.createElement(z,{className:"float-right",type:"submit",isLoading:o,disabled:!(h.email.length>0&&h.password.length>0)},"log-in"),r.a.createElement(l.Link,{to:"/login/reset"},"forgot password?"))))}function ee(){return r.a.createElement("div",{className:"Settings"},r.a.createElement(b.LinkContainer,{to:"/settings/password"},r.a.createElement(z,{block:!0},"Change Password")))}function te(){var e=Object(p.k)(),t=Object(n.useState)(!1),a=Object(m.a)(t,2),c=a[0],o=a[1],l=H({code:"",email:""}),i=Object(m.a)(l,2),b=i[0],f=i[1],h=Object(n.useState)(!1),E=Object(m.a)(h,2),g=E[0],y=E[1],v=Object(n.useState)(!1),x=Object(m.a)(v,2),k=x[0],O=x[1];function j(e){return w.apply(this,arguments)}function w(){return(w=Object(u.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),O(!0),e.prev=2,e.next=5,d.a.currentAuthenticatedUser();case 5:return a=e.sent,e.next=8,d.a.updateUserAttributes(a,{email:b.email});case 8:o(!0),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),Z(e.t0),O(!1);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}function I(e){return N.apply(this,arguments)}function N(){return(N=Object(u.a)(s.a.mark((function t(a){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),y(!0),t.prev=2,t.next=5,d.a.verifyCurrentUserAttributeSubmit("email",b.code);case 5:e.push("/settings"),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(2),Z(t.t0),y(!1);case 12:case"end":return t.stop()}}),t,null,[[2,8]])})))).apply(this,arguments)}return r.a.createElement("div",null,c?r.a.createElement(B.a,{onSubmit:I},r.a.createElement(B.a.Group,{controlId:"code"},r.a.createElement(B.a.Label,null,"Confirmation Code"),r.a.createElement(B.a.Control,{autoFocus:!0,type:"tel",value:b.code,onChange:f}),r.a.createElement(B.a.Text,null,"Please check your email (",b.email,") for the confirmation code.")),r.a.createElement(z,{block:!0,type:"submit",isLoading:g,disabled:!(b.code.length>0)},"Confirm")):r.a.createElement(B.a,{onSubmit:j},r.a.createElement(B.a.Group,{controlId:"email"},r.a.createElement(B.a.Label,null,"Email"),r.a.createElement(B.a.Control,{autoFocus:!0,type:"email",value:b.email,onChange:f})),r.a.createElement(z,{block:!0,type:"submit",isLoading:k,disabled:!(b.email.length>0)},"Update Email")))}var ae=a(39);function ne(){var e=H({code:"",email:"",password:"",confirmPassword:""}),t=Object(m.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(!1),i=Object(m.a)(o,2),p=i[0],b=i[1],h=Object(n.useState)(!1),E=Object(m.a)(h,2),g=E[0],y=E[1],v=Object(n.useState)(!1),x=Object(m.a)(v,2),k=x[0],O=x[1],j=Object(n.useState)(!1),w=Object(m.a)(j,2),I=w[0],N=w[1];function C(e){return _.apply(this,arguments)}function _(){return(_=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),N(!0),e.prev=2,e.next=5,d.a.forgotPassword(a.email);case 5:b(!0),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),Z(e.t0),N(!1);case 12:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}function S(e){return F.apply(this,arguments)}function F(){return(F=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),O(!0),e.prev=2,e.next=5,d.a.forgotPasswordSubmit(a.email,a.code,a.password);case 5:y(!0),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),Z(e.t0),O(!1);case 12:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}return r.a.createElement(f.a,{id:"password"},r.a.createElement("h2",null,"password reset"),p?g?r.a.createElement("div",{className:"success"},r.a.createElement(ae.a,{icon:"ok"}),r.a.createElement("p",null,"Your password has been reset."),r.a.createElement("p",null,r.a.createElement(l.Link,{to:"/login"},"Click here to login with your new credentials."))):r.a.createElement("form",{onSubmit:S},r.a.createElement(B.a.Group,{controlId:"code"},r.a.createElement(B.a.Label,null,"Confirmation Code"),r.a.createElement(B.a.Control,{autoFocus:!0,type:"tel",value:a.code,onChange:c}),r.a.createElement(B.a.Text,null,"Please check your email (",a.email,") for the confirmation code.")),r.a.createElement("hr",null),r.a.createElement(B.a.Group,{controlId:"password"},r.a.createElement(B.a.Label,null,"New Password"),r.a.createElement(B.a.Control,{type:"password",value:a.password,onChange:c})),r.a.createElement(B.a.Group,{controlId:"confirmPassword"},r.a.createElement(B.a.Label,null,"Confirm Password"),r.a.createElement(B.a.Control,{type:"password",value:a.confirmPassword,onChange:c})),r.a.createElement(z,{block:!0,type:"submit",isLoading:k,disabled:!(a.code.length>0&&a.password.length>0&&a.password===a.confirmPassword)},"Confirm")):r.a.createElement("form",{onSubmit:C},r.a.createElement(B.a.Group,{controlId:"email"},r.a.createElement(B.a.Label,null,"Email"),r.a.createElement(B.a.Control,{autoFocus:!0,type:"email",value:a.email,onChange:c})),r.a.createElement(z,{block:!0,type:"submit",isLoading:I,disabled:!(a.email.length>0)},"Send Confirmation")))}function re(){var e=Object(p.k)(),t=H({password:"",oldPassword:"",confirmPassword:""}),a=Object(m.a)(t,2),c=a[0],o=a[1],l=Object(n.useState)(!1),i=Object(m.a)(l,2),b=i[0],h=i[1];function E(){return(E=Object(u.a)(s.a.mark((function t(a){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),h(!0),t.prev=2,t.next=5,d.a.currentAuthenticatedUser();case 5:return n=t.sent,t.next=8,d.a.changePassword(n,c.oldPassword,c.password);case 8:e.push("/settings"),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(2),Z(t.t0),h(!1);case 15:case"end":return t.stop()}}),t,null,[[2,11]])})))).apply(this,arguments)}return r.a.createElement(f.a,{id:"password"},r.a.createElement(B.a,{onSubmit:function(e){return E.apply(this,arguments)}},r.a.createElement(B.a.Group,{controlId:"oldPassword"},r.a.createElement(B.a.Label,null,"Old Password"),r.a.createElement(B.a.Control,{type:"password",onChange:o,value:c.oldPassword})),r.a.createElement("hr",null),r.a.createElement(B.a.Group,{controlId:"password"},r.a.createElement(B.a.Label,null,"New Password"),r.a.createElement(B.a.Control,{type:"password",onChange:o,value:c.password})),r.a.createElement(B.a.Group,{controlId:"confirmPassword"},r.a.createElement(B.a.Label,null,"Confirm Password"),r.a.createElement(B.a.Control,{type:"password",onChange:o,value:c.confirmPassword})),r.a.createElement(z,{block:!0,type:"submit",disabled:!(c.oldPassword.length>0&&c.password.length>0&&c.password===c.confirmPassword),isLoading:b},"Change Password")))}function ce(){var e=H({email:"",password:"",confirmPassword:"",confirmationCode:""}),t=Object(m.a)(e,2),a=t[0],c=t[1],o=Object(p.k)(),l=Object(n.useState)(null),i=Object(m.a)(l,2),b=i[0],f=i[1],h=I().userHasAuthenticated,E=Object(n.useState)(!1),g=Object(m.a)(E,2),y=g[0],v=g[1];function x(e){return k.apply(this,arguments)}function k(){return(k=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),v(!0),e.prev=2,e.next=5,d.a.signUp({username:a.email,password:a.password});case 5:n=e.sent,v(!1),f(n),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),Z(e.t0),v(!1);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}function O(e){return j.apply(this,arguments)}function j(){return(j=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),v(!0),e.prev=2,e.next=5,d.a.confirmSignUp(a.email,a.confirmationCode);case 5:return e.next=7,d.a.signIn(a.email,a.password);case 7:h(!0),U.a.post("billing/customer/create","/billing/customer/create",{body:{email:a.email,facilityId:"7edad966-198d-4ee2-8802-02f188e8f62c"}}).then(function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.status&&t.customer&&t.customer.id?d.a.currentAuthenticatedUser().then((function(e){return d.a.updateUserAttributes(e,{"custom:stripe_customer_id":t.customer.id})})).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)})):t.error&&console.log(t.error);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o.push("/"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),Z(e.t0),v(!1);case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}return r.a.createElement(_.a,{id:"signup"},r.a.createElement(_.a.Header,null,"New Customer?",r.a.createElement("span",{className:"float-right"},"Sign Up")),r.a.createElement(_.a.Body,null,null===b?r.a.createElement(B.a,{onSubmit:x},r.a.createElement(B.a.Group,{controlId:"email"},r.a.createElement(B.a.Label,null,"Email"),r.a.createElement(B.a.Control,{autoFocus:!0,type:"email",value:a.email,onChange:c})),r.a.createElement(B.a.Group,{controlId:"password"},r.a.createElement(B.a.Label,null,"Password"),r.a.createElement(B.a.Control,{type:"password",value:a.password,onChange:c})),r.a.createElement(B.a.Group,{controlId:"confirmPassword"},r.a.createElement(B.a.Label,null,"Confirm Password"),r.a.createElement(B.a.Control,{type:"password",onChange:c,value:a.confirmPassword})),r.a.createElement(z,{className:"float-right",type:"submit",isLoading:y,disabled:!(a.email.length>0&&a.password.length>0&&a.password===a.confirmPassword)},"sign-up")):r.a.createElement(B.a,{onSubmit:O},r.a.createElement(B.a.Group,{controlId:"confirmationCode"},r.a.createElement(B.a.Label,null,"Confirmation Code"),r.a.createElement(B.a.Control,{autoFocus:!0,type:"tel",onChange:c,value:a.confirmationCode}),r.a.createElement(B.a.Text,null,"Please check your email for the code.")),r.a.createElement(z,{block:!0,type:"submit",isLoading:y,disabled:!(a.confirmationCode.length>0)},"verify"))))}var oe=a(142),le=a(300),ie=a(296),se=a(297),ue=(a(449),a(294)),me=(a(560),a(10)),de=a.n(me),pe=a(295),be=a.n(pe),fe=a(86),he="e986bca0-ff41-11ea-8196-af25e422bd08",Ee="ff1694c0-ffa8-11ea-bfbc-4f270cb046f3",ge={bgn:"\u043b\u0432"};function ye(){var e=Object(n.useState)(void 0),t=Object(m.a)(e,2),a=t[0],c=t[1],o=Object(fe.useStripe)(),l=Object(fe.useElements)(),i=Object(n.useState)(void 0),b=Object(m.a)(i,2),h=b[0],y=b[1],v=Object(n.useState)(void 0),x=Object(m.a)(v,2),k=x[0],O=x[1];Object(n.useEffect)((function(){h||d.a.currentAuthenticatedUser().then((function(e){O(e.attributes.email),y(e)})).catch(console.log)}));var w=new Date;w.setHours(14,0,0,0),w.setDate(w.getDate()+1);var I=new Date;I.setHours(12,0,0,0),I.setMonth(w.getMonth()+12);var N=Object(n.useState)({name:"",vat_number:"",email:k,telephone:"",address:"",from:w.toISOString(),months:12,to:I.toISOString(),unit:void 0,unitCategory:void 0,unitVariant:void 0,unitId:void 0,paymentFrequency:"month",coupon:"",termsAccepted:!1}),C=Object(m.a)(N,2),S=C[0],F=C[1],T=Object(n.useState)(void 0),L=Object(m.a)(T,2),A=L[0],P=L[1],M=Object(n.useState)(void 0),D=Object(m.a)(M,2),q=D[0],G=D[1],V=Object(n.useState)({code:void 0,name:void 0,valid:void 0,invalid:void 0,message:void 0,discount:{percent:0,amount:0}}),Y=Object(m.a)(V,2),R=Y[0],H=Y[1];Object(n.useEffect)((function(){k&&U.a.get("limelockers","/".concat(he,"/").concat(Ee,"/catalog?from=").concat(S.from,"&to=").concat(S.to)).then((function(e){if(Q(!1),e.status&&e.catalog){var t=Object.keys(e.catalog).some((function(t){return Object.keys(e.catalog[t]).some((function(a){return e.catalog[t][a].available.units.some((function(e){return!!e.held&&e.held.for===k}))}))})),a=t?Object.keys(e.catalog).find((function(t){return Object.keys(e.catalog[t]).some((function(a){return e.catalog[t][a].available.units.some((function(e){return!!e.held&&e.held.for===k}))}))})):Object.keys(e.catalog)[0],n=t?Object.keys(e.catalog[a]).find((function(t){return e.catalog[a][t].available.units.some((function(e){return!!e.held&&e.held.for===k}))})):Object.keys(e.catalog[a]).find((function(t){return!!e.catalog[a][t].available.units.length})),r=t?e.catalog[a][n].available.units.find((function(e){return!!e.held&&e.held.for===k})).unitId:e.catalog[a][n].available.units.length?e.catalog[a][n].available.units.sort((function(e,t){return e.name>t.name?1:-1}))[0].unitId:void 0;F((function(e){return Object(K.a)({},e,{unitId:r})})),F((function(e){return Object(K.a)({},e,{unit:"".concat(a,"/").concat(n)})})),P(e.catalog),console.log(e)}else console.log(e)})).catch(console.log)}),[k,S.from,S.to]),Object(n.useEffect)((function(){if(A){var e=S.unit?S.unit.split("/"):[Object.keys(A)[0],Object.keys(A[Object.keys(A)[0]]).find((function(e){return!!A[Object.keys(A)[0]][e].available.units.length}))],t=Object(m.a)(e,2),a=t[0],n=t[1],r=A[a][n].available.units.some((function(e){return!!e.held&&e.held.for===k}))?A[a][n].available.units.find((function(e){return!!e.held&&e.held.for===k})).unitId:A[a][n].available.units.length?A[a][n].available.units.sort((function(e,t){return e.name>t.name?1:-1}))[0].unitId:void 0;F((function(e){return Object(K.a)({},e,{unitId:r})})),G(A[a][n]),He(Ze(A[a][n],S.paymentFrequency,"bgn",R))}}),[k,A,R,S.paymentFrequency,S.unit]);var Z=Object(n.useState)(!0),J=Object(m.a)(Z,2),X=J[0],Q=J[1],ee=Object(n.useState)(!1),te=Object(m.a)(ee,2),ae=te[0],ne=te[1],re=Object(n.useState)(!1),ce=Object(m.a)(re,2),me=ce[0],pe=ce[1],ye=Object(n.useState)({}),ve=Object(m.a)(ye,2),xe=ve[0],ke=ve[1],Oe=Object(n.useState)(!1),je=Object(m.a)(Oe,2),we=je[0],Ie=je[1],Ne=Object(n.useState)(!1),Ce=Object(m.a)(Ne,2),_e=Ce[0],Se=Ce[1],Fe=Object(n.useState)({}),Te=Object(m.a)(Fe,2),Le=Te[0],Ae=Te[1],Pe=Object(n.useState)({}),Me=Object(m.a)(Pe,2),De=Me[0],qe=Me[1],Ge=Object(n.useState)({countryCode:"BG",vatNumber:"",name:"",address:""}),Ve=Object(m.a)(Ge,2),Ye=Ve[0],Re=Ve[1],Ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=Object(n.useRef)(new be.a({messages:e,validators:t}));return[a]}(),Be=Object(m.a)(Ue,1)[0];Object(n.useEffect)((function(){S.coupon&&S.coupon.length>9&&U.a.post("limelockers","/validation/coupon",{body:{coupon:S.coupon}}).then((function(e){e.error&&"resource_missing"===e.error.code?H((function(e){return Object(K.a)({},e,{invalid:!0,valid:!1,message:"Unrecognised discount code: ".concat(S.coupon)})})):e.coupon&&e.coupon.valid&&H((function(t){return Object(K.a)({},t,{name:e.coupon.name,discount:{percent:e.coupon.percent_off||0,amount:e.coupon.amount_off||0},invalid:!1,valid:!0,message:"Discount code applied: ".concat(e.coupon.name)})}))})).catch(console.log)}),[S.coupon]);var $e={id:void 0,currency:"bgn",amount:{base:0,subtotal:0,total:0},discount:{percent:0,amount:0},vat:{percent:20,amount:0}},ze=Object(n.useState)($e),We=Object(m.a)(ze,2),Ke=We[0],He=We[1];function Ze(e,t,a,n){var r=e.product.price[t][a].amount,c=n.discount.percent?{percent:n.discount.percent,amount:r*(n.discount.percent/100)}:n.discount,o=r-c.amount,l=e.product.price[t][a].tax&&e.product.price[t][a].tax.VAT?{percent:e.product.price[t][a].tax.VAT.percentage,amount:o*(e.product.price[t][a].tax.VAT.percentage/100)}:{percent:0,amount:0},i=o+l.amount;return{id:e.product.price[t][a].id,currency:a,amount:{base:r,baseWithVat:r+l.amount,subtotal:o,total:i},discount:c,vat:l}}function Je(e,t){S.unit!=="".concat(e,"/").concat(t)&&A[e][t].available.units.length&&F((function(a){return Object(K.a)({},a,{unit:"".concat(e,"/").concat(t)})}))}function Xe(e){return Qe.apply(this,arguments)}function Qe(){return(Qe=Object(u.a)(s.a.mark((function e(t){var a,n,r,c,o,l,i,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.target,n=a.id,r=a.value,c="countryCode"===n?r:Ye.countryCode,o="vatNumber"===n?r:Ye.vatNumber,Re({countryCode:c,vatNumber:o}),l={AT:/^ATU[A-Z0-9]{9,9}$/,BE:/^BE[0-9]{10,10}$/,BG:/^BG[0-9]{9,10}$/,CY:/^CY[A-Z0-9]{9,9}$/,CZ:/^CZ[0-9]{8,10}$/,DE:/^DE[0-9]{9,9}$/,DK:/^DK[0-9]{8,8}$/,EE:/^EE[0-9]{9,9}$/,EL:/^EL[0-9]{9,9}$/,ES:/^ES[A-Z0-9]{9,9}$/,FI:/^FI[0-9]{8,8}$/,FR:/^FR[A-Z0-9]{2,2}[0-9]{9,9}$/,GB:/^GB[0-9]{9,9}$|^GB[0-9]{12,12}$|^GBGD[0-9]{3,3}$|^GBHA[0-9]{3,3}$/,HU:/^HU[0-9]{8,8}$/,IE:/^IE[A-Z0-9]{8,8}$/,IT:/^IT[0-9]{11,11}$/,LT:/^LT[0-9]{9,9}$|^LT[0-9]{12,12}$/,LU:/^LU[0-9]{8,8}$/,LV:/^LV[0-9]{11,11}$/,MT:/^MT[0-9]{8,8}$/,NL:/^NL[A-Z0-9]{12,12}$/,PL:/^PL[0-9]{10,10}$/,PT:/^PT[0-9]{9,9}$/,SE:/^SE[0-9]{12,12}$/,SI:/^SI[0-9]{8,8}$/,SK:/^SK[0-9]{10,10}$/},"".concat(c).concat(o).match(l[c])?(qe(Object(K.a)({},De,{vat_number:"".concat(c).concat(o," matches a known ").concat(c," VAT number format.")})),"vat_number"in Le&&(Le.vat_number,i=Object(j.a)(Le,["vat_number"]),Ae(i)),pe(!0),U.a.post("limelockers","/validation/vat",{body:{countryCode:c,vatNumber:o}}).then((function(e){if(pe(!1),e.status&&e.entity&&e.entity.valid){if(qe(Object(K.a)({},De,{vat_number:"".concat(c).concat(o," is registered with VIES.")})),"vat_number"in Le){Le.vat_number;var t=Object(j.a)(Le,["vat_number"]);Ae(t)}Re({valid:e.entity.valid,name:e.entity.name,address:e.entity.address,countryCode:e.entity.countryCode,vatNumber:e.entity.vatNumber})}else if(e.entity&&!e.entity.valid){if(Ae(Object(K.a)({},Le,{vat_number:"".concat(c).concat(o," is not registered with VIES.")})),"vat_number"in De){De.vat_number;var a=Object(j.a)(De,["vat_number"]);qe(a)}}else console.log(e.error?e.error:e)})).catch(console.log)):(Ae(Object(K.a)({},Le,{vat_number:"".concat(c).concat(o," does not match a known ").concat(c," VAT number format.")})),"vat_number"in De&&(De.vat_number,u=Object(j.a)(De,["vat_number"]),qe(u)));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function et(e){var t=e.cancelAt,a=e.customerId,n=e.paymentMethodId,r=e.reservation,c=e.defaultTaxRates,o=e.coupon,l=r.priceId,i=r.unitCategoryId,s=r.unitVariantId,u=r.unitId,m=r.from,d=r.to,p=[{priceId:l,unitCategoryId:i,unitVariantId:s,unitId:u}];return U.a.put("limelockers","/".concat(he,"/").concat(Ee,"/subscription"),{body:{email:k,cancelAt:t,customerId:a,items:p,paymentMethodId:n,reservation:{from:m,to:d},defaultTaxRates:c,coupon:o}}).then((function(e){if(!e.status&&e.error)throw e.error;return console.log("[API.put (/".concat(he,"/").concat(Ee,"/subscription) response]"),e),e})).then((function(e){return{paymentMethodId:n,reservation:r,defaultTaxRates:c,subscription:e.subscription}})).then(tt).then(nt).then(at).catch((function(e){console.error("[API.put (/".concat(he,"/").concat(Ee,"/subscription) error]"),e)}))}function tt(e){var t=e.subscription,a=e.invoice,n=e.reservation,r=e.defaultTaxRates,c=e.paymentMethodId,l=e.isRetry;if(t&&"active"===t.status)return{subscription:t,reservation:n,defaultTaxRates:r,paymentMethodId:c};var i=a?a.payment_intent:t.latest_invoice.payment_intent;return"requires_action"===i.status||!0===l&&"requires_payment_method"===i.status?o.confirmCardPayment(i.client_secret,{payment_method:c}).then((function(e){if(e.error)throw e;if("succeeded"===e.paymentIntent.status)return{subscription:t,reservation:n,defaultTaxRates:r,paymentMethodId:c,invoice:a}})).catch((function(e){console.log(e)})):{subscription:t,reservation:n,defaultTaxRates:r,paymentMethodId:c}}function at(e){e.subscription.status}function nt(e){var t=e.subscription,a=e.paymentMethodId,n=e.reservation,r=e.defaultTaxRates;if("active"===t.status)return{subscription:t,paymentMethodId:a,reservation:n,defaultTaxRates:r};if("requires_payment_method"===t.latest_invoice.payment_intent.status)throw localStorage.setItem("latestInvoiceId",t.latest_invoice.id),localStorage.setItem("latestInvoicePaymentIntentStatus",t.latest_invoice.payment_intent.status),new Error("The card transaction was declined.");return{subscription:t,paymentMethodId:a,reservation:n,defaultTaxRates:r}}function rt(e){var t=e.customerId,a=e.invoiceId,n=e.paymentMethodId;return U.a.post("limelockers","/".concat(he,"/").concat(Ee,"/invoice"),{body:{customerId:t,invoiceId:a,paymentMethodId:n}}).then((function(e){if(e.error)throw e;return e})).then((function(e){return{invoice:e,paymentMethodId:n,isRetry:!0}})).then(tt).then(at).catch((function(e){console.log(e)}))}function ct(e,t){switch(e){case"BG":return{line1:t.match(/^(.*)\s\u043e\u0431\u043b\./i)[1],city:t.match(/\u0433\u0440\.(.*)\s[0-9]+$/i)[1],state:t.match(/\u043e\u0431\u043b\.(.*),/i)[1],postal_code:t.match(/\s([0-9]*)$/i)[1],country:e};default:return{line1:t,country:e}}}function ot(){return(ot=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),ne(!0),d.a.currentAuthenticatedUser().then(function(){var e=Object(u.a)(s.a.mark((function e(t){var a,n,r,i,u,m,p,b,f,h,E,g,y,v,x,k,O;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("custom:stripe_customer_id"in(a=t.attributes)){e.next=12;break}return e.next=4,U.a.put("limelockers","/".concat(he,"/").concat(Ee,"/customer"),{body:{email:a.email}});case 4:if(!((n=e.sent).status&&n.customer&&n.customer.id)){e.next=11;break}return e.next=8,d.a.updateUserAttributes(t,{"custom:stripe_customer_id":n.customer.id});case 8:t.attributes["custom:stripe_customer_id"]=n.customer.id,e.next=12;break;case 11:n.error&&console.log(n.error);case 12:if(d.a.updateUserAttributes(t,Object(K.a)({name:Ye.name||S.name,phone_number:S.telephone,address:Ye.address||S.address},Ye.valid&&!!Ye.vatNumber&&{"custom:vat_number":"".concat(Ye.countryCode).concat(Ye.vatNumber)})).then((function(e){return console.log("[Auth.updateUserAttributes response]",e)})).catch((function(e){return console.error("[Auth.updateUserAttributes error]",e)})),U.a.post("limelockers","/".concat(he,"/").concat(Ee,"/customer"),{body:Object(K.a)({customerId:t.attributes["custom:stripe_customer_id"]},(Ye.valid&&Ye.name||S.name)&&{name:Ye.valid&&Ye.name?Ye.name:S.name},{},(Ye.valid&&Ye.address||S.address)&&{address:Ye.valid&&Ye.address?ct(Ye.countryCode,Ye.address):{line1:S.address}},{},S.telephone&&{phone:S.telephone},{},Ye.valid&&!!Ye.vatNumber&&{taxId:{type:"eu_vat",value:"".concat(Ye.countryCode).concat(Ye.vatNumber)}})}).then((function(e){console.log("[API.post (/".concat(he,"/").concat(Ee,"/customer) response]"),e),e.status&&!e.error||console.log("[user]",t)})).catch((function(e){return console.log("[API.post (/".concat(he,"/").concat(Ee,"/customer) error]"),e)})),o&&l){e.next=16;break}return e.abrupt("return");case 16:return r=l.getElement(fe.CardElement),i=localStorage.getItem("latestInvoicePaymentIntentStatus"),e.next=20,o.createPaymentMethod({type:"card",card:r});case 20:if(u=e.sent,m=u.error,p=u.paymentMethod,!m){e.next=35;break}console.log("[stripe.createPaymentMethod error]",m),e.t0=m.type,e.next="validation_error"===e.t0?28:32;break;case 28:return"card"in De&&(De.card,b=Object(j.a)(De,["card"]),qe(b)),Ae(Object(K.a)({},Le,{card:m.message})),ne(!1),e.abrupt("break",33);case 32:return e.abrupt("break",33);case 33:e.next=46;break;case 35:console.log("[stripe.PaymentMethod created]",p),qe(Object(K.a)({},De,{card:!0})),"card"in Le&&(Le.card,f=Object(j.a)(Le,["card"]),Ae(f)),h=p.id,E=t.attributes["custom:stripe_customer_id"],g=[q.product.price[S.paymentFrequency].bgn.tax.VAT.id],y=de()(S.to).format("X"),v=R.valid&&S.coupon?S.coupon:void 0,x=q.available.units.find((function(e){return e.unitId===S.unitId})),k={priceId:q.product.price[S.paymentFrequency].bgn.id,unitCategoryId:x.unitCategoryId,unitVariantId:x.unitVariantId,unitId:x.unitId,from:de()(S.from).format(),to:de()(S.to).format()},"requires_payment_method"===i?(O=localStorage.getItem("latestInvoiceId"),rt({customerId:E,invoiceId:O,paymentMethodId:h})):et({cancelAt:y,customerId:E,paymentMethodId:h,reservation:k,defaultTaxRates:g,coupon:v}).then((function(e){ne(!1),c("/bookings")})).catch((function(e){return console.log("[createSubscription error]",e)}));case 46:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log("[Auth.currentAuthenticatedUser error]",e)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){h&&h.attributes&&(F((function(e){return Object(K.a)({},e,{name:h.attributes.name?h.attributes.name:e.name,email:h.attributes.email?h.attributes.email:e.email,address:h.attributes.address?h.attributes.address:e.address,telephone:h.attributes.phone_number?h.attributes.phone_number:e.telephone,vat_number:"custom:vat_number"in h.attributes?h.attributes["custom:vat_number"]:e.vat_number})})),"custom:vat_number"in h.attributes&&(Se(!0),Re((function(e){return{countryCode:h.attributes["custom:vat_number"].slice(0,2),vatNumber:h.attributes["custom:vat_number"].slice(2),valid:!0,name:h.attributes.name,address:h.attributes.address}}))))}),[h]),Object(n.useEffect)((function(){ke((function(e){return Object(K.a)({},e,{vat_number:!0,name:!0,address:!0})}))}),[Ye]),a?r.a.createElement(p.c,{to:a}):X?r.a.createElement("div",{className:"text-center"},r.a.createElement($.a,{animation:"border",size:"lg",style:{marginTop:"250px",marginBottom:"250px"}})):q?r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{id:"book-form"},r.a.createElement(B.a,{onSubmit:function(e){return ot.apply(this,arguments)},className:"clearfix",noValidate:!0},r.a.createElement(E.a,null,r.a.createElement(g.a,null,r.a.createElement(B.a.Group,null,r.a.createElement(B.a.Check,{type:"checkbox",label:"Do you require a VAT invoice?",checked:_e,onChange:function(){Se(!_e)}})),_e?r.a.createElement(r.a.Fragment,null,r.a.createElement(B.a.Label,null,"VAT Number:"),r.a.createElement(B.a.Group,{className:"form-inline"},r.a.createElement(B.a.Control,{style:{marginRight:"10px"},id:"countryCode",as:"select",value:Ye.countryCode,onChange:Xe},["AT","BE","BG","CY","CZ","DE","DK","EE","EL","ES","FI","FR","GB","HU","IE","IT","LT","LU","LV","MT","NL","PL","PT","SE","SI","SK"].map((function(e){return r.a.createElement("option",{key:e},e)}))),r.a.createElement(B.a.Control,{style:{marginRight:"10px"},id:"vatNumber",type:"text",placeholder:"9999999",value:Ye.vatNumber,onChange:Xe,isValid:Ye.valid||!_e,isInvalid:!me&&"vat_number"in Le}),me?r.a.createElement($.a,{style:{marginLeft:"10px"},animation:"border",size:"sm"}):null,r.a.createElement(B.a.Text,{className:"text-muted"},"VAT numbers are validated with the ",r.a.createElement("a",{href:"https://ec.europa.eu/taxation_customs/vies"},"European Commission VIES VAT number validator"),". On verification, your invoice will be addressed to the company name and address registered with VIES."),r.a.createElement(B.a.Text,{style:{color:"rgb(123, 179, 44)"}},De.vat_number),r.a.createElement(B.a.Text,{className:"text-danger"},Le.vat_number))):null,r.a.createElement(B.a.Group,{controlId:"name"},r.a.createElement(B.a.Label,null,"Name:"),r.a.createElement(B.a.Control,{type:"text",placeholder:"individual or company name",value:Ye.name||S.name,isValid:Be.current.fieldValid("name"),isInvalid:"name"in xe&&!Be.current.fieldValid("name"),onChange:function(e){var t=e.target,a=t.id,n=t.value;F((function(e){return Object(K.a)({},e,Object(W.a)({},a,n))})),ke(Object(K.a)({},xe,{name:!0})),Be.current.showMessageFor("name")},disabled:""!==Ye.name&&Ye.valid}),r.a.createElement(B.a.Text,{className:"text-muted"},"This name will appear on your invoice. Use your own name or if your company will claim a VAT rebate, check the VAT invoice box above and we'll use the company name associated with your EU registered, VAT number."),r.a.createElement(B.a.Text,null,"name"in xe?Be.current.message("name",Ye.name||S.name,"required",{className:"text-danger",messages:{required:"Please enter a name."}}):null)),r.a.createElement(B.a.Group,{controlId:"telephone"},r.a.createElement(B.a.Label,null,"Telephone:"),r.a.createElement(B.a.Control,{type:"phone",placeholder:"+359 555 123 456",value:S.telephone,isValid:Be.current.fieldValid("telephone"),isInvalid:"telephone"in xe&&!Be.current.fieldValid("telephone"),onChange:function(e){var t=e.target,a=t.id,n=t.value;F((function(e){return Object(K.a)({},e,Object(W.a)({},a,n))})),ke(Object(K.a)({},xe,{telephone:!0})),Be.current.showMessageFor("telephone")}}),r.a.createElement(B.a.Text,{className:"text-muted"},"This number will receive communications about your self-storage and related billing only."),r.a.createElement(B.a.Text,null,"telephone"in xe?Be.current.message("telephone",S.telephone,"required|phone",{className:"text-danger",messages:{required:"Please enter a telephone number."}}):null)),r.a.createElement(B.a.Group,{controlId:"address"},r.a.createElement(B.a.Label,null,"Address"),r.a.createElement(B.a.Control,{as:"textarea",rows:3,value:Ye.address||S.address,isValid:(Ye.valid||!_e)&&!!S.address,onChange:function(e){var t=e.target,a=t.id,n=t.value;F((function(e){return Object(K.a)({},e,Object(W.a)({},a,n))}))},disabled:""!==Ye.address&&Ye.valid}),r.a.createElement(B.a.Text,{className:"text-muted"},"This address will appear on invoices only. We do not send postal mail of any kind."))),r.a.createElement(g.a,null,r.a.createElement(B.a.Group,null,r.a.createElement(B.a.Label,null,"What type of locker or parking space do you require?"),r.a.createElement("ul",null,Object.keys(A).map((function(e){return r.a.createElement("li",{key:e,className:S.unit.startsWith(e)?"":"text-muted"},r.a.createElement("span",null,e,":"),Object.keys(A[e]).map((function(t){return r.a.createElement(B.a.Check,{key:t},r.a.createElement(B.a.Check.Input,{style:{cursor:"pointer"},type:"radio",disabled:0===A[e][t].available.units.length,checked:S.unit==="".concat(e,"/").concat(t),onChange:function(){Je(e,t)}}),r.a.createElement(B.a.Check.Label,{style:{cursor:0===A[e][t].available.units.length?"not-allowed":"pointer"},className:S.unit==="".concat(e,"/").concat(t)?"active":"text-muted",onClick:function(){Je(e,t)}},"".concat(t).concat(0===A[e][t].available.units.length?" - not available":"")))})))}))),q.dimensions&&q.dimensions.locker?r.a.createElement(B.a.Text,{className:"text-muted"},"width: ".concat(q.dimensions.locker.width/100,"m"),"\xa0 \xd7 \xa0","depth: ".concat(q.dimensions.locker.depth/100,"m"),"\xa0 \xd7 \xa0","height: ".concat(q.dimensions.locker.height/100,"m")):null),r.a.createElement(B.a.Group,null,r.a.createElement(B.a.Label,null,"Choose your ",S.unit.includes("enclosed lockers")?"locker":S.unit.includes("bicycle")?"bike rack space":"motorcycle parking bay",":"),r.a.createElement("br",null),q.available.units.filter((function(e){return!e.held||e.held.for===h.attributes.email})).sort((function(e,t){return e.held||t.held?e.held&&t.held?0:e.held?-1:1:e.name===t.name?0:e.name>t.name?1:-1})).slice(0,5).map((function(e){return r.a.createElement(B.a.Check,{inline:!0,key:e.unitId},r.a.createElement(B.a.Check.Input,{style:{cursor:"pointer"},type:"radio",checked:S.unitId===e.unitId,onChange:function(){F((function(t){return Object(K.a)({},t,{unitId:e.unitId})}))}}),r.a.createElement(B.a.Check.Label,{style:{cursor:"pointer"},className:S.unitId===e.unitId?"active":"text-muted",onClick:function(){F((function(t){return Object(K.a)({},t,{unitId:e.unitId})}))}},"".concat(e.name).concat(e.held&&e.held.for===h.attributes.email?" - reserved for you":"")))})),r.a.createElement(B.a.Text,{className:"text-muted"},S.unitId?q.available.units.find((function(e){return e.unitId===S.unitId})).description:null)),r.a.createElement(B.a.Group,null,r.a.createElement(E.a,null,r.a.createElement(g.a,null,r.a.createElement(B.a.Label,null,"Start Date:"),r.a.createElement("br",null),r.a.createElement(ue.SingleDatePicker,{displayFormat:"MMM DD YYYY",date:de()(S.from),onDateChange:function(e){F((function(t){return Object(K.a)({},t,{from:e.toISOString(),to:e.add(S.months,"M").toISOString()})}))},focused:we,onFocusChange:function(e){var t=e.focused;return Ie(t)},id:"from"})),r.a.createElement(g.a,null,r.a.createElement(B.a.Label,null,"year"===S.paymentFrequency?"Years":"Months"," Required:"),r.a.createElement("br",null),r.a.createElement(B.a.Control,{id:"months",type:"number",min:1,max:"year"===S.paymentFrequency?Math.floor(3):36,value:"year"===S.paymentFrequency?Math.floor(S.months/12):S.months,onChange:function(e){var t="year"===S.paymentFrequency?12*Math.max(Math.min(parseInt(e.target.value),Math.floor(3)),1):Math.max(Math.min(parseInt(e.target.value),36),1);F((function(e){return Object(K.a)({},e,{months:t,to:de()(S.from).add(t,"M").toISOString()})}))}})),r.a.createElement(g.a,null,r.a.createElement(B.a.Label,null,"End Date:"),r.a.createElement("br",null),Intl.DateTimeFormat(void 0,{year:"numeric",month:"short",day:"numeric"}).format(new Date(S.to)),"year"===S.paymentFrequency?r.a.createElement(B.a.Text,{className:"active"},"".concat(Math.floor(S.months/12)," month").concat(Math.floor(S.months/12)>1?"s":""," free!")):null)),r.a.createElement(B.a.Text,{className:"text-muted"},"Self-storage may be reserved for between 1 and ",36," months (",13*Math.floor(3)," months for annual payment customers). Subject to availability, you may amend your booking to change to an earlier or later end date at any time.")),r.a.createElement(B.a.Group,{controlId:"coupon"},r.a.createElement(B.a.Label,null,"discount code:"),r.a.createElement(B.a.Control,{type:"text",value:S.coupon,isValid:!!R.valid,isInvalid:!!R.invalid,disabled:!!R.valid,onChange:function(e){var t=e.target,a=t.id,n=t.value;F((function(e){return Object(K.a)({},e,Object(W.a)({},a,n))}))}}),r.a.createElement(B.a.Text,{className:R.message?R.invalid?"text-danger":"text-success":"text-muted"},R.message?R.message:"If you have a discount code, enter it here.")),r.a.createElement(B.a.Group,null,r.a.createElement(B.a.Check,null,r.a.createElement(B.a.Check.Input,{style:{cursor:"pointer"},type:"radio",disabled:!1,checked:"year"!==S.paymentFrequency,onChange:function(e){F((function(e){return Object(K.a)({},e,{paymentFrequency:"month"})}))}}),r.a.createElement(B.a.Check.Label,{style:{cursor:0===q.available.units.length?"not-allowed":"pointer"},className:"year"!==S.paymentFrequency?"active":"text-muted",onClick:function(e){F((function(e){return Object(K.a)({},e,{paymentFrequency:"month"})}))}},"monthly payment: ",r.a.createElement("span",null,R.valid?r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"text-muted",style:{textDecoration:"line-through",color:"#000000"}},"\u043b\u0432",Number.parseFloat(Ze(q,"month","bgn",R).amount.baseWithVat).toFixed(2)),"\xa0",r.a.createElement("span",null,"\u043b\u0432",Number.parseFloat(Ze(q,"month","bgn",R).amount.total).toFixed(2))):r.a.createElement("span",null,"\u043b\u0432",Number.parseFloat(Ze(q,"month","bgn",R).amount.total).toFixed(2))," bgn")," per month")),r.a.createElement(B.a.Check,null,r.a.createElement(B.a.Check.Input,{style:{cursor:"pointer"},type:"radio",disabled:!1,checked:"year"===S.paymentFrequency,onChange:function(e){F((function(e){return Object(K.a)({},e,{paymentFrequency:"year"})}))}}),r.a.createElement(B.a.Check.Label,{style:{cursor:0===q.available.units.length?"not-allowed":"pointer"},className:"year"===S.paymentFrequency?"active":"text-muted",onClick:function(e){F((function(e){return Object(K.a)({},e,{paymentFrequency:"year"})}))}},"annual payment: ",r.a.createElement("span",null,R.valid?r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"text-muted",style:{textDecoration:"line-through",color:"#000000"}},"\u043b\u0432",Number.parseFloat(Ze(q,"year","bgn",R).amount.baseWithVat).toFixed(2)),"\xa0",r.a.createElement("span",null,"\u043b\u0432",Number.parseFloat(Ze(q,"year","bgn",R).amount.total).toFixed(2))):r.a.createElement("span",null,"\u043b\u0432",Number.parseFloat(Ze(q,"year","bgn",R).amount.total).toFixed(2))," bgn")," per year")),r.a.createElement(B.a.Text,{className:"text-muted"},"Customers choosing the annual payment option will receive 12 months for the price of 11.",r.a.createElement("br",null),"- A saving of ",r.a.createElement("span",null,"\u043b\u0432",Number.parseFloat(Ze(q,"month","bgn",R).amount.total).toFixed(2)," bgn")," per year.")),r.a.createElement("hr",null),r.a.createElement(oe.a,{size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"text-muted"},"description"),r.a.createElement("th",{className:"text-muted text-right"},"qty"),r.a.createElement("th",{className:"text-muted text-right"},"unit price"),r.a.createElement("th",{className:"text-muted text-right"},"amount"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"4",className:"text-muted"},de()(S.from).format("MMM D, YYYY"),"\xa0-\xa0",de()(S.from).add(1,"year"===S.paymentFrequency?"Y":"M").format("MMM D, YYYY"))),r.a.createElement("tr",null,r.a.createElement("td",null,S.unit),r.a.createElement("td",{className:"text-right"},"1"),r.a.createElement("td",{className:"text-right text-muted"},ge.bgn,"year"===S.paymentFrequency?Number.parseFloat(Ke.amount.base/11*12).toFixed(2):Number.parseFloat(Ke.amount.base).toFixed(2)),r.a.createElement("td",{className:"text-right"},ge.bgn,"year"===S.paymentFrequency?Number.parseFloat(Ke.amount.base/11*12).toFixed(2):Number.parseFloat(Ke.amount.base).toFixed(2))),"year"===S.paymentFrequency?r.a.createElement("tr",{className:"active"},r.a.createElement("td",{colSpan:"3",className:"text-right"},"discount: ",r.a.createElement("em",null,"annual payment")," (1 month free)"),r.a.createElement("td",{className:"text-right"},"- ",ge.bgn,Number.parseFloat(Ke.amount.base/11).toFixed(2))):null,Ke.discount.amount?r.a.createElement("tr",{className:"active"},r.a.createElement("td",{colSpan:"3",className:"text-right"},"discount: ",r.a.createElement("em",null,R.name)," (",Ke.discount.percent,"%)"),r.a.createElement("td",{className:"text-right"},"-",ge.bgn,Number.parseFloat(Ke.discount.amount).toFixed(2))):null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3",className:"text-right"},"subtotal"),r.a.createElement("td",{className:"text-right"},ge.bgn,Number.parseFloat(Ke.amount.subtotal).toFixed(2))),Ke.vat.amount?r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3",className:"text-muted text-right"},"VAT - Bulgaria (",Ke.vat.percent,"%)"),r.a.createElement("td",{className:"text-right"},ge.bgn,Number.parseFloat(Ke.vat.amount).toFixed(2))):null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3",className:"text-right"},r.a.createElement("strong",null,S.months/("year"===S.paymentFrequency?12:1)>1?"year"===S.paymentFrequency?"yearly":"monthly":null," total ",S.months/("year"===S.paymentFrequency?12:1)>1?r.a.createElement("span",{className:"text-muted"},"(",S.months/("year"===S.paymentFrequency?12:1)," payments)"):null)),r.a.createElement("td",{className:"text-right"},r.a.createElement("strong",null,ge.bgn,Number.parseFloat(Ke.amount.total).toFixed(2)))))),r.a.createElement("hr",null),r.a.createElement(B.a.Group,null,r.a.createElement(B.a.Label,null,"Payment Card:"),r.a.createElement(fe.CardElement,{id:"stripe-payment-method",onChange:function(){if("card"in Le){Le.card;var e=Object(j.a)(Le,["card"]);Ae(e)}},options:{style:{base:{color:"rgb(48, 11, 11)",fontFamily:"Roboto, sans-serif",fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#aab7c4"},iconColor:"#ff3399"},invalid:{color:"#fa755a",iconColor:"#fa755a"}}}}),r.a.createElement(B.a.Text,{className:"text-danger"},Le.card),r.a.createElement(B.a.Text,{className:"text-muted"},"You have requested use of self-storage space for a period of ",S.months/("year"===S.paymentFrequency?12:1)," ","year"===S.paymentFrequency?"years":"months",".",r.a.createElement("br",null),S.months/("year"===S.paymentFrequency?12:1)>1?r.a.createElement("span",null,"Subscription payments will be debited from your chosen payment method today and will repeat each ","year"===S.paymentFrequency?"year":"month","."):r.a.createElement("span",null,"One payment will be debited from your chosen payment method, when you submit this form."))),r.a.createElement(B.a.Group,null,r.a.createElement(B.a.Check,{type:"checkbox",label:r.a.createElement("span",null,"I have read and accepted the ",r.a.createElement("a",{href:"/terms",target:"_blank"},"terms and conditions"),"."),checked:S.termsAccepted,onChange:function(){F((function(e){return Object(K.a)({},e,{termsAccepted:!e.termsAccepted})}))}})))),r.a.createElement(z,{type:"submit",className:"float-right",isLoading:ae,disabled:!(0===Object.keys(Le).length&&Be.current.allValid()&&o&&l&&S.termsAccepted)},"reserve and pay"))),r.a.createElement(f.a,{id:"book-units"},r.a.createElement(le.a,{activeKey:S.unit.split("/")[0],onSelect:function(e){return function(e){S.unit.startsWith(e)||Je(e,Object.keys(A[e]).find((function(t){return!!A[e][t].available.units.length})))}(e)}},Object.keys(A).map((function(e){return r.a.createElement(ie.a,{key:e,eventKey:e,title:e},r.a.createElement(se.a,null,Object.keys(A[e]).map((function(t){return r.a.createElement(_.a,{key:t,className:S.unit==="".concat(e,"/").concat(t)?"active":"text-muted",onClick:function(){return Je(e,t)}},r.a.createElement(_.a.Header,{style:{cursor:"pointer"},as:"div"},r.a.createElement("span",{className:"float-right availability-".concat(A[e][t].available.units.length<1?"zero":A[e][t].available.units.length<3?"low":"high")},"available: ",r.a.createElement("strong",null,A[e][t].available.units.length))),r.a.createElement(_.a.Img,{variant:"top",src:A[e][t].image.url,className:"mx-auto",style:{cursor:"pointer",width:"100%",opacity:S.unit==="".concat(e,"/").concat(t)?1:.2}}),r.a.createElement(_.a.Body,null,r.a.createElement(_.a.Title,null,t),r.a.createElement(_.a.Text,null,A[e][t].description),r.a.createElement(_.a.Text,{as:"div"},r.a.createElement("strong",null,"unit price:"),r.a.createElement("ul",null,r.a.createElement("li",{className:"price active"},r.a.createElement("span",null,"\u043b\u0432",Number.parseFloat(Ze(A[e][t],"year","bgn",R).amount.total).toFixed(2)," bgn")," yearly"),r.a.createElement("li",{className:"price active"},r.a.createElement("span",null,"\u043b\u0432",Number.parseFloat(Ze(A[e][t],"month","bgn",R).amount.total).toFixed(2)," bgn")," monthly"))),A[e][t].dimensions&&r.a.createElement(_.a.Text,{as:"div"},r.a.createElement("strong",null,"locker size"),r.a.createElement("ul",null,Object.keys(A[e][t].dimensions.locker).map((function(a){return r.a.createElement("li",{key:a},a,": ",A[e][t].dimensions.locker[a]/100," meter")})),r.a.createElement("li",null,"area: ",(A[e][t].dimensions.locker.width/100*(A[e][t].dimensions.locker.depth/100)).toFixed(1)," m",r.a.createElement("sup",null,"2")),r.a.createElement("li",null,"volume: ",(A[e][t].dimensions.locker.width/100*(A[e][t].dimensions.locker.height/100)*(A[e][t].dimensions.locker.depth/100)).toFixed(1)," m",r.a.createElement("sup",null,"3"))),r.a.createElement("strong",null,"door size"),r.a.createElement("ul",null,Object.keys(A[e][t].dimensions.door).map((function(a){return r.a.createElement("li",{key:a},a,": ",A[e][t].dimensions.door[a]/100," meter")}))))))}))))}))))):null}var ve=a(162),xe={currency:{symbol:"\u043b\u0432",code:"bgn"}};function ke(){var e=Object(n.useState)(!0),t=Object(m.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(void 0),l=Object(m.a)(o,2),i=l[0],s=l[1],u=Object(n.useState)(void 0),d=Object(m.a)(u,2),p=d[0],h=d[1],E=Object(n.useState)([]),g=Object(m.a)(E,2),y=g[0],v=g[1],x=Object(n.useState)("r0"),k=Object(m.a)(x,2),O=k[0],j=k[1];return Object(n.useEffect)((function(){i||U.a.get("limelockers","/".concat("e986bca0-ff41-11ea-8196-af25e422bd08","/").concat("ff1694c0-ffa8-11ea-bfbc-4f270cb046f3","/account")).then((function(e){e.status&&e.account?(s(e.account),console.log(e.account)):c(!1)})).catch(console.error),p||U.a.get("limelockers","/".concat("e986bca0-ff41-11ea-8196-af25e422bd08","/").concat("ff1694c0-ffa8-11ea-bfbc-4f270cb046f3","/catalog?from=").concat(de()().add(72,"M").toISOString(),"&to=").concat(de()().add(73,"M").toISOString())).then((function(e){e.status&&e.catalog&&(h(e.catalog),console.log(e.catalog))})).catch(console.error)})),Object(n.useEffect)((function(){i&&p&&(i.reservations&&i.reservations.length&&v(i.reservations.filter((function(e){return!!e.unitCategoryId&&!!e.unitVariantId&&!!e.unitId&&!!e.subscription})).map((function(e){var t={unitCategoryId:e.unitCategoryId,name:Object.keys(p).find((function(t){return Object.keys(p[t]).some((function(a){return p[t][a].available.units.some((function(t){return t.unitId===e.unitId}))}))}))},a={unitVariantId:e.unitVariantId,name:Object.keys(p[t.name]).find((function(a){return p[t.name][a].available.units.some((function(t){return t.unitId===e.unitId}))}))},n={unitId:e.unitId,name:p[t.name][a.name].available.units.find((function(t){return t.unitId===e.unitId})).name};return Object(K.a)({},e,{unitCategory:t,unitVariant:a,unit:n})})).sort((function(e,t){return e.subscription.latest_invoice.created>t.subscription.latest_invoice.created?-1:1}))),c(!1))}),[i,p]),r.a.createElement(f.a,{id:"bookings"},r.a.createElement("h2",null,"Bookings"),y&&y.length?r.a.createElement(ve.a,{activeKey:O},y.map((function(e,t){return r.a.createElement(_.a,{key:"r".concat(t)},r.a.createElement(ve.a.Toggle,{as:_.a.Header,eventKey:t,onClick:function(){j("r".concat(t))}},"Unit ",e.unit.name,r.a.createElement("span",{className:"float-right"},de()(e.from).format("MMM YYYY")," ~ ",de()(e.to).format("MMM YYYY"))),r.a.createElement(ve.a.Collapse,{eventKey:"r".concat(t)},r.a.createElement(_.a.Body,null,r.a.createElement("a",{className:"float-right",href:e.subscription.latest_invoice.invoice_pdf},r.a.createElement(ae.a,{icon:["far","file-pdf"],color:"#ff3399"})),r.a.createElement("a",{className:"float-right",href:e.subscription.latest_invoice.hosted_invoice_url,style:{marginRight:"0.5em"},target:"_blank",rel:"noopener noreferrer"},"invoice"),e.subscription.latest_invoice.payment_intent.charges.data&&e.subscription.latest_invoice.payment_intent.charges.data.length&&e.subscription.latest_invoice.payment_intent.charges.data[0].receipt_url?r.a.createElement("a",{className:"float-right",href:e.subscription.latest_invoice.payment_intent.charges.data[0].receipt_url,style:{marginRight:"0.5em"},target:"_blank",rel:"noopener noreferrer"},"receipt"):null,r.a.createElement(_.a.Title,null,"Latest invoice"),r.a.createElement(oe.a,{size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"text-muted"},"description"),r.a.createElement("th",{className:"text-muted text-right"},"quantity"),r.a.createElement("th",{className:"text-muted text-right"},"unit price"),r.a.createElement("th",{className:"text-muted text-right"},"amount"))),r.a.createElement("tbody",null,e.subscription.latest_invoice.lines.data.map((function(e){return r.a.createElement("tr",{key:e.subscription_item},r.a.createElement("td",{className:"text-muted"},de()(1e3*e.period.start).format("MMM-DD-YY")," ~ ",de()(1e3*e.period.end).format("MMM-DD-YY"),"\xa0-\xa0",e.price.nickname.replace("corona ","")),r.a.createElement("td",{className:"text-muted text-right"},e.quantity),r.a.createElement("td",{className:"text-muted text-right"},Number.parseFloat(e.price.unit_amount/100).toFixed(2)),r.a.createElement("td",{className:"text-right"},xe.currency.symbol,Number.parseFloat(e.amount/100).toFixed(2)," ",xe.currency.code))})),e.subscription.latest_invoice.discount&&e.subscription.latest_invoice.discount.coupon&&e.subscription.latest_invoice.discount.coupon.percent_off?r.a.createElement("tr",{className:"active"},r.a.createElement("td",{colSpan:"3",className:"text-right"},"discount: ",e.subscription.latest_invoice.discount.coupon.name," (",e.subscription.latest_invoice.discount.coupon.percent_off,"%)"),r.a.createElement("td",{className:"text-right"},"-",xe.currency.symbol,Number.parseFloat(e.subscription.latest_invoice.subtotal*(e.subscription.latest_invoice.discount.coupon.percent_off/100)/100).toFixed(2)," ",xe.currency.code)):null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3",className:"text-right"},"subtotal"),r.a.createElement("td",{className:"text-right"},xe.currency.symbol,Number.parseFloat((e.subscription.latest_invoice.discount&&e.subscription.latest_invoice.discount.coupon&&e.subscription.latest_invoice.discount.coupon.percent_off?e.subscription.latest_invoice.subtotal*((100-e.subscription.latest_invoice.discount.coupon.percent_off)/100):e.subscription.latest_invoice.subtotal)/100).toFixed(2)," ",xe.currency.code)),e.subscription.latest_invoice.total_tax_amounts.map((function(t){var a=e.subscription.latest_invoice.default_tax_rates.find((function(e){return e.id===t.tax_rate}));return r.a.createElement("tr",{key:t.tax_rate},r.a.createElement("td",{colSpan:"3",className:"text-muted text-right"},a.display_name," - ",a.jurisdiction," (",a.percentage,"%)"),r.a.createElement("td",{className:"text-right"},xe.currency.symbol,Number.parseFloat(t.amount/100).toFixed(2)," ",xe.currency.code))})),r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3",className:"text-right"},"total"),r.a.createElement("td",{className:"text-right"},xe.currency.symbol,Number.parseFloat(e.subscription.latest_invoice.total/100).toFixed(2)," ",xe.currency.code)),r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3",className:"text-right"},e.subscription.latest_invoice.paid?r.a.createElement("span",{className:"success"},"Payment received ",de()(1e3*e.subscription.latest_invoice.status_transitions.paid_at).format("HH:mm DD/MM/YYYY"),", with thanks!"):r.a.createElement("span",{className:"active"},"Payment due")),r.a.createElement("td",{className:"text-right"},r.a.createElement("span",{className:e.subscription.latest_invoice.paid?"success":"active"},xe.currency.symbol,Number.parseFloat(e.subscription.latest_invoice.amount_paid/100).toFixed(2)," ",xe.currency.code))))),r.a.createElement("pre",null))))}))):r.a.createElement("div",{className:"text-center"},a?r.a.createElement($.a,{animation:"border",size:"lg"}):r.a.createElement("div",null,r.a.createElement("p",null,"no bookings found"),r.a.createElement(b.LinkContainer,{to:"/book"},r.a.createElement(S.a,{className:"book-now btn"},"book now")))))}function Oe(){var e=Object(n.useState)(void 0),t=Object(m.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){a||d.a.currentAuthenticatedUser().then((function(e){c(e)})).catch(console.log)})),a?r.a.createElement(f.a,{id:"profile"},r.a.createElement("h2",null,"Profile"),r.a.createElement(E.a,null,r.a.createElement(g.a,{className:"text-right"},"name:"),r.a.createElement(g.a,null,a.attributes.name)),r.a.createElement(E.a,null,r.a.createElement(g.a,{className:"text-right"},"email:"),r.a.createElement(g.a,null,a.attributes.email)),r.a.createElement(E.a,null,r.a.createElement(g.a,{className:"text-right"},"phone:"),r.a.createElement(g.a,null,a.attributes.phone_number)),r.a.createElement(E.a,null,r.a.createElement(g.a,{className:"text-right"},"address:"),r.a.createElement(g.a,null,a.attributes.address))):null}function je(){return r.a.createElement("div",{className:"NotFound"},r.a.createElement("h3",null,"Sorry, page not found!"))}function we(){return r.a.createElement(p.g,null,r.a.createElement(p.d,{exact:!0,path:"/"},r.a.createElement(A,null)),r.a.createElement(p.d,{exact:!0,path:"/privacy"},r.a.createElement(G,null)),r.a.createElement(p.d,{exact:!0,path:"/terms"},r.a.createElement(R,null)),r.a.createElement(C,{exact:!0,path:"/login"},r.a.createElement(f.a,{id:"login"},r.a.createElement(E.a,null,r.a.createElement(g.a,null,r.a.createElement(Q,null)),r.a.createElement(g.a,null,r.a.createElement(ce,null))))),r.a.createElement(C,{exact:!0,path:"/login/reset"},r.a.createElement(ne,null)),r.a.createElement(C,{exact:!0,path:"/signup"},r.a.createElement(f.a,{id:"signup"},r.a.createElement(E.a,null,r.a.createElement(g.a,null,r.a.createElement(Q,null)),r.a.createElement(g.a,null,r.a.createElement(ce,null))))),r.a.createElement(N,{exact:!0,path:"/book"},r.a.createElement(ye,null)),r.a.createElement(N,{exact:!0,path:"/bookings"},r.a.createElement(ke,null)),r.a.createElement(N,{exact:!0,path:"/profile"},r.a.createElement(Oe,null)),r.a.createElement(N,{exact:!0,path:"/settings"},r.a.createElement(ee,null)),r.a.createElement(N,{exact:!0,path:"/settings/email"},r.a.createElement(te,null)),r.a.createElement(N,{exact:!0,path:"/settings/password"},r.a.createElement(re,null)),r.a.createElement(p.d,null,r.a.createElement(je,null)))}var Ie=a(88),Ne=(window.location.hostname,{STRIPE_KEY:"pk_test_51GskzHLWkJbcmCTlYQ1pisYlrbICWZ8bWVTNVIvU3hS6XYTYH3ls2PaxikdzE8zmJLr5VrsSp1gxTkqkMm5DV8Zf00VYAsg3zL",apiGateway:{REGION:"us-east-1",URL:"https://hy1sab4b1f.execute-api.us-east-1.amazonaws.com/dev"}}),Ce=Object(K.a)({env:"bearslairs.eu"===window.location.hostname?"production":"staging",s3:{REGION:"us-east-1",BUCKET:"bearslairs-api-dev-serverlessdeploymentbucket-1tt1ibsw7svan"},cognito:{REGION:"us-east-1",USER_POOL_ID:"us-east-1_nhmWSzeBZ",APP_CLIENT_ID:"6ejs5t57eraer0urepjm6lmi0h",IDENTITY_POOL_ID:"us-east-1:06ca8ae5-f4de-4373-8a72-de5637b22559"}},Ne),_e=Ce.env;var Se=function(){var e=Object(p.k)(),t=Object(p.l)(),a=encodeURI("I'd like to book a locker"),c={latitude:41.820626,longitude:23.478217,address:encodeURI('Bears Lairs, ul. "Kosherinata", 2770 \u043a\u0432. \u0413\u0440\u0430\u043c\u0430\u0434\u0435\u0442\u043e, Bansko'),waypoints:[{latitude:41.820112,longitude:23.47402}],id:"ChIJcywcFXevqxQRFjKaC0zq1K0"},o=Ie.isMobile?Ie.isAndroid?"intent://send/".concat("+359877804825","#Intent;scheme=smsto;package=com.whatsapp;action=android.intent.action.SENDTO;end"):"https://wa.me/".concat("+359877804825","?text=").concat(a):Ie.isFirefox||Ie.isSafari?"https://web.whatsapp.com/send?phone=".concat("+359877804825","&text=").concat(a):"whatsapp://send?phone=".concat("+359877804825","&text=").concat(a),l=Ie.isAndroid?"intent://send/".concat("+359877804825","#Intent;scheme=smsto;package=com.viber;action=android.intent.action.SENDTO;end"):"viber://chat?number=".concat("+359877804825","&text=").concat(a),i=Ie.isAndroid?"intent://geo:".concat(c.latitude,",").concat(c.longitude,"?destination=").concat(c.address,"/@").concat(c.latitude,",").concat(c.longitude,"&destination_place_id=").concat(c.id,"&waypoints=").concat(c.waypoints.map((function(e){return e.latitude+","+e.longitude})).join("|"),"#Intent;scheme=directions;package=com.google.android.apps.maps;action=android.intent.action.ACTION_VIEW;end"):"https://www.google.com/maps/dir/?api=1&destination=".concat(c.address,"/@").concat(c.latitude,",").concat(c.longitude,"&destination_place_id=").concat(c.id,"&waypoints=").concat(c.waypoints.map((function(e){return e.latitude+","+e.longitude})).join("|")),j=Object(n.useState)(!0),I=Object(m.a)(j,2),N=I[0],C=I[1],_=Object(n.useState)(!1),S=Object(m.a)(_,2),F=S[0],T=S[1];function L(){return(L=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.a.currentSession();case 3:T(!0),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),"No current user"!==e.t0&&Z(e.t0);case 9:C(!1);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function A(){return(A=Object(u.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a.signOut();case 2:T(!1),e.push("/login");case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(n.useEffect)((function(){!function(){L.apply(this,arguments)}()}),[]),!N&&r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{fluid:!0},r.a.createElement(E.a,null,r.a.createElement(b.LinkContainer,{to:"/",style:{cursor:"pointer"}},r.a.createElement(h.a,{src:"/logo.png",className:"m-auto"})),"production"!==_e?r.a.createElement("span",{className:"pull-right",style:{fontSize:"2em",color:"#ff3399",marginRight:"50px"}},_e):null),r.a.createElement(v.a,{collapseOnSelect:!0,expand:"lg"},r.a.createElement(v.a.Toggle,{"aria-controls":"site-nav"}),r.a.createElement(v.a.Collapse,{id:"site-nav"},r.a.createElement(y.a,{className:"mr-auto"},"/book"!==t.pathname?r.a.createElement(b.LinkContainer,{to:"/book"},r.a.createElement(k.a,{className:"btn"},"book now")):null)),r.a.createElement("span",null,r.a.createElement(ae.a,{className:"fa-sm fa-flip-horizontal",icon:"phone"}),"\xa0",r.a.createElement("span",{className:"text-muted"},"+359")," ",r.a.createElement("strong",null,"(0) 877 804 825"),"\xa0",r.a.createElement(O.a,{placement:"top",delay:{show:250,hide:400},overlay:r.a.createElement("div",{className:"rounded-pill",style:{fontSize:"2em",backgroundColor:"#fff",padding:"20px"}},r.a.createElement(ae.a,{icon:["fab","viber"],color:"#665ca7"}),"\xa0 Send us a Viber message")},r.a.createElement("a",{href:l},r.a.createElement(ae.a,{icon:["fab","viber"],color:"#665ca7"}))),"\xa0 \xa0",r.a.createElement(O.a,{placement:"top",delay:{show:250,hide:400},overlay:r.a.createElement("div",{className:"rounded-pill",style:{fontSize:"2em",backgroundColor:"#fff",padding:"20px"}},r.a.createElement(ae.a,{icon:["fab","whatsapp-square"],color:"#0dc143"}),"\xa0 Send us a WhatsApp message")},r.a.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(ae.a,{icon:["fab","whatsapp-square"],color:"#0dc143"}))),"\xa0 \xa0",r.a.createElement(O.a,{placement:"top",delay:{show:250,hide:400},overlay:r.a.createElement("div",{className:"rounded-pill",style:{fontSize:"2em",backgroundColor:"#fff",padding:"20px"}},r.a.createElement(ae.a,{icon:["fab","facebook"],color:"#4862a3"}),"\xa0 Find us on Facebook")},r.a.createElement("a",{href:"https://www.facebook.com/BearsLairsBansko",target:"_blank",rel:"noopener noreferrer"},r.a.createElement(ae.a,{icon:["fab","facebook"],color:"#4862a3"}))),"\xa0 \xa0",r.a.createElement(O.a,{placement:"top",delay:{show:250,hide:400},overlay:r.a.createElement("div",{className:"rounded-pill",style:{fontSize:"2em",backgroundColor:"#fff",padding:"20px"}},r.a.createElement(ae.a,{icon:["fas","map-marked-alt"],color:"#cccccc"}),"\xa0 Get directions")},r.a.createElement("a",{href:i,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(ae.a,{icon:["fas","map-marked-alt"],color:"#ccccc"})))),r.a.createElement(x.a,{className:"pull-right",title:r.a.createElement(ae.a,{className:"fa-sm",icon:[F?"fas":"far","user"]}),drop:"left"},F?r.a.createElement(r.a.Fragment,null,r.a.createElement(b.LinkContainer,{to:"/bookings"},r.a.createElement(x.a.Item,null,"bookings")),r.a.createElement(b.LinkContainer,{to:"/profile"},r.a.createElement(x.a.Item,null,"profile")),r.a.createElement(b.LinkContainer,{to:"/settings/password"},r.a.createElement(x.a.Item,null,"change password")),r.a.createElement(x.a.Divider,null),r.a.createElement(x.a.Item,{onClick:function(){return A.apply(this,arguments)}},"log-out")):r.a.createElement(r.a.Fragment,null,r.a.createElement(b.LinkContainer,{to:"/signup"},r.a.createElement(x.a.Item,null,"sign-up")),r.a.createElement(b.LinkContainer,{to:"/login"},r.a.createElement(x.a.Item,null,"log-in")))))),r.a.createElement(w.Provider,{value:{isAuthenticated:F,userHasAuthenticated:T}},r.a.createElement(we,null)),r.a.createElement(f.a,{id:"footer",fluid:!0},r.a.createElement(f.a,null,r.a.createElement(E.a,{className:"justify-content-xl-center justify-content-md-center"},r.a.createElement(g.a,{xl:6},r.a.createElement(b.LinkContainer,{to:"/privacy"},r.a.createElement(k.a,{as:"a"},"privacy")),"\xa0|\xa0",r.a.createElement(b.LinkContainer,{to:"/terms"},r.a.createElement(k.a,{as:"a"},"terms and conditions")),"\xa0|\xa0",r.a.createElement("a",{href:"mailto:info@bearslairs.eu"},"info@bearslairs.eu"),r.a.createElement("hr",null),"\xa9 2020, Bears Lairs EOOD, Bulgaria. All rights reserved")))))},Fe=a(72),Te=a(298),Le=a(120),Ae=a(189),Pe=a(159),Me=a(160);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Le.b.add(Pe.b,Me.a,Me.c,Me.b,Ae.a,Pe.a,Ae.b,Pe.c);var De=Object(Te.a)(Ce.STRIPE_KEY);Fe.a.configure({Auth:{mandatorySignIn:!0,region:Ce.cognito.REGION,userPoolId:Ce.cognito.USER_POOL_ID,identityPoolId:Ce.cognito.IDENTITY_POOL_ID,userPoolWebClientId:Ce.cognito.APP_CLIENT_ID},Storage:{region:Ce.s3.REGION,bucket:Ce.s3.BUCKET,identityPoolId:Ce.cognito.IDENTITY_POOL_ID},API:{endpoints:[{name:"limelockers",endpoint:Ce.apiGateway.URL,region:Ce.apiGateway.REGION}]}}),o.a.render(r.a.createElement(l.BrowserRouter,null,r.a.createElement(fe.Elements,{stripe:De},r.a.createElement(Se,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[310,1,2]]]);
//# sourceMappingURL=main.d3ea21d9.chunk.js.map